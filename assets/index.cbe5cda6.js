import{c as K,l as D,Y as N,v as V,U as I}from"./use-translate.b9b887aa.js";import{n as B,m as T,c as j,t as f,w as E}from"./with-install.78f37d35.js";import{z as S,C,e as a,D as L,u as _,j as z,v as M,T as H,Q as $,S as F}from"./vue-libs.b44bc779.js";import{H as Q}from"./constant.80c6de18.js";import{u as U}from"./use-touch.04ca7093.js";import{L as Y}from"./index.9ca1885c.js";const[Z,b]=K("key"),v=S({name:Z,props:{type:String,text:B,color:String,wider:Boolean,large:Boolean,loading:Boolean},emits:["press"],setup(e,{emit:o,slots:r}){const i=C(!1),u=U(),m=s=>{u.start(s),i.value=!0},y=s=>{u.move(s),u.direction.value&&(i.value=!1)},h=s=>{i.value&&(r.default||D(s),i.value=!1,o("press",e.text,e.type))},d=()=>{if(e.loading)return a(Y,{class:b("loading-icon")},null);const s=r.default?r.default():e.text;switch(e.type){case"delete":return s;case"extra":return s;default:return s}};return()=>a("div",{class:b("wrapper",{wider:e.wider}),onTouchstartPassive:m,onTouchmovePassive:y,onTouchend:h,onTouchcancel:h},[a("div",{role:"button",tabindex:0,class:b([e.color,{large:e.large,active:i.value,delete:e.type==="delete"}])},[d()])])}});function q(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$(e)}const[G,c]=K("number-keyboard"),J={show:Boolean,title:String,theme:T("default"),zIndex:B,teleport:[String,Object],maxlength:j(1/0),modelValue:T(""),transition:f,blurOnClose:f,showDeleteKey:f,randomKeyOrder:Boolean,closeButtonText:String,deleteButtonText:String,closeButtonLoading:Boolean,hideOnClickOutside:f,safeAreaInsetBottom:f,extraKey:{type:[String,Array],default:""}};function R(e){for(let o=e.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1)),i=e[o];e[o]=e[r],e[r]=i}return e}const W=S({name:G,props:J,emits:["show","hide","blur","input","close","delete","update:modelValue"],setup(e,{emit:o,slots:r}){const i=C(),u=()=>{const t=Array(9).fill("").map((n,l)=>({text:l+1}));return e.randomKeyOrder&&R(t),t},m=()=>[...u(),{text:e.extraKey,type:"extra"},{text:0},{text:e.showDeleteKey?e.deleteButtonText:"",type:e.showDeleteKey?"delete":""}],y=()=>{const t=u(),{extraKey:n}=e,l=Array.isArray(n)?n:[n];return l.length===1?t.push({text:0,wider:!0},{text:l[0],type:"extra"}):l.length===2&&t.push({text:l[0],type:"extra"},{text:0},{text:l[1],type:"extra"}),t},h=L(()=>e.theme==="custom"?y():m()),d=()=>{e.show&&o("blur")},s=()=>{o("close"),e.blurOnClose&&d()},P=()=>o(e.show?"show":"hide"),x=(t,n)=>{if(t===""){n==="extra"&&d();return}const l=e.modelValue;n==="delete"?(o("delete"),o("update:modelValue",l.slice(0,l.length-1))):n==="close"?s():l.length<e.maxlength&&(o("input",t),o("update:modelValue",l+t))},A=()=>{const{title:t,theme:n,closeButtonText:l}=e,g=r["title-left"],w=l&&n==="default";if(!!(t||w||g))return a("div",{class:c("header")},[g&&a("span",{class:c("title-left")},[g()]),t&&a("h2",{class:c("title")},[t]),w&&a("button",{type:"button",class:[c("close"),Q],onClick:s},[l])])},O=()=>h.value.map(t=>{const n={};return t.type==="delete"&&(n.default=r.delete),t.type==="extra"&&(n.default=r["extra-key"]),a(v,{key:t.text,text:t.text,type:t.type,wider:t.wider,color:t.color,onPress:x},n)}),k=()=>{if(e.theme==="custom")return a("div",{class:c("sidebar")},[e.showDeleteKey&&a(v,{large:!0,text:e.deleteButtonText,type:"delete",onPress:x},{delete:r.delete}),a(v,{large:!0,text:e.closeButtonText,type:"close",color:"blue",loading:e.closeButtonLoading,onPress:x},null)])};return _(()=>e.show,t=>{e.transition||o(t?"show":"hide")}),e.hideOnClickOutside&&N(i,d,{eventName:"touchstart"}),()=>{const t=A(),n=a(H,{name:e.transition?"van-slide-up":""},{default:()=>[z(a("div",{ref:i,style:V(e.zIndex),class:c({unfit:!e.safeAreaInsetBottom,"with-title":!!t}),onAnimationend:P,onTouchstartPassive:I},[t,a("div",{class:c("body")},[a("div",{class:c("keys")},[O()]),k()])]),[[M,e.show]])]});return e.teleport?a(F,{to:e.teleport},q(n)?n:{default:()=>[n]}):n}}}),X=E(W),se=X;export{se as V};
