import{c as D,p as U,d as x,i as j,e as g,f as V,g as q}from"./use-translate.b9b887aa.js";import{m as v,n as p,a as A,u as I,w as E}from"./with-install.78f37d35.js";import{m as G,u as H}from"./mount-component.652baed3.js";import{I as $}from"./index.ee2eceac.js";import{P as F}from"./index.afee4208.js";import{L as J}from"./index.9ca1885c.js";import{z as K,u as b,N as Q,G as R,e as r,A as T,C as W,P as X}from"./vue-libs.b44bc779.js";let d=0;function Y(e){e?(d||document.body.classList.add("van-toast--unclickable"),d++):d&&(d--,d||document.body.classList.remove("van-toast--unclickable"))}const[Z,m]=D("toast"),_=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],ee={icon:String,show:Boolean,type:v("text"),overlay:Boolean,width:p,height:p,message:p,iconSize:p,duration:A(2e3),position:v("middle"),teleport:[String,Object],className:I,iconPrefix:String,transition:v("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:I,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean},M=K({name:Z,props:ee,emits:["update:show"],setup(e,{emit:t}){let a,u=!1;const l=()=>{const n=e.show&&e.forbidClick;u!==n&&(u=n,Y(u))},f=n=>t("update:show",n),w=()=>{e.closeOnClick&&f(!1)},h=()=>clearTimeout(a),O=()=>{const{icon:n,type:o,iconSize:S,iconPrefix:B,loadingType:L}=e;if(n||o==="success"||o==="fail")return r($,{name:n||o,size:S,class:m("icon"),classPrefix:B},null);if(o==="loading")return r(J,{class:m("loading"),size:S,type:L},null)},c=()=>{const{type:n,message:o}=e;if(j(o)&&o!=="")return n==="html"?r("div",{key:0,class:m("text"),innerHTML:String(o)},null):r("div",{class:m("text")},[o])};return b(()=>[e.show,e.forbidClick],l),b(()=>[e.show,e.type,e.message,e.duration],()=>{h(),e.show&&e.duration>0&&(a=setTimeout(()=>{f(!1)},e.duration))}),Q(l),R(l),()=>{const{width:n,height:o}=e;return r(F,T({style:{width:x(n),height:x(o)},class:[m([e.position,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:w,onClosed:h,"onUpdate:show":f},U(e,_)),{default:()=>[O(),c()]})}}}),N={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let s=[],C=!1,y=g({},N);const k=new Map;function z(e){return q(e)?e:{message:e}}function te(){const{instance:e,unmount:t}=G({setup(){const a=W(""),{open:u,state:l,close:f,toggle:w}=H(),h=()=>{C&&(s=s.filter(c=>c!==e),t())},O=()=>r(M,T(l,{onClosed:h,"onUpdate:show":w}),null);return b(a,c=>{l.message=c}),X().render=O,{open:u,clear:f,message:a}}});return e}function ne(){if(!s.length||C){const e=te();s.push(e)}return s[s.length-1]}function i(e={}){if(!V)return{};const t=ne(),a=z(e);return t.open(g({},y,k.get(a.type||y.type),a)),t}const P=e=>t=>i(g({type:e},z(t)));i.loading=P("loading");i.success=P("success");i.fail=P("fail");i.clear=e=>{var t;s.length&&(e?(s.forEach(a=>{a.clear()}),s=[]):C?(t=s.shift())==null||t.clear():s[0].clear())};function oe(e,t){typeof e=="string"?k.set(e,t):g(y,e)}i.setDefaultOptions=oe;i.resetDefaultOptions=e=>{typeof e=="string"?k.delete(e):(y=g({},N),k.clear())};i.allowMultiple=(e=!0)=>{C=e};i.install=e=>{e.use(E(M)),e.config.globalProperties.$toast=i};export{i as T};
