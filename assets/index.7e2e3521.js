import{c as J,d as D,q as Q,E as X,l as w,B as F,i as z,V as Y,D as Z}from"./use-translate.b9b887aa.js";import{c as d,t as g,n as h,w as p}from"./with-install.78f37d35.js";import{z as ee,C as A,D as v,u as T,e as o,j as I,v as y,A as R,q as te}from"./vue-libs.b44bc779.js";import{H as k}from"./constant.80c6de18.js";import{c as ne}from"./interceptor.e861aa70.js";const[ae,S]=J("stepper"),le=200,se=600,P=(t,i)=>String(t)===String(i),ie={min:d(1),max:d(1/0),name:d(""),step:d(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:g,showMinus:g,showInput:g,longPress:g,allowEmpty:Boolean,modelValue:h,inputWidth:h,buttonSize:h,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:d(1),decimalLength:h},ue=ee({name:ae,props:ie,emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(t,{emit:i}){const c=e=>{const{min:n,max:s,allowEmpty:b,decimalLength:l}=t;return b&&e===""||(e=F(String(e),!t.integer),e=e===""?0:+e,e=Number.isNaN(e)?+n:e,e=Math.max(Math.min(+s,e),+n),z(l)&&(e=e.toFixed(+l))),e},q=()=>{var s;const e=(s=t.modelValue)!=null?s:t.defaultValue,n=c(e);return P(n,t.modelValue)||i("update:modelValue",n),n};let u;const N=A(),a=A(q()),r=v(()=>t.disabled||t.disableMinus||a.value<=+t.min),m=v(()=>t.disabled||t.disablePlus||a.value>=+t.max),G=v(()=>({width:D(t.inputWidth),height:D(t.buttonSize)})),x=v(()=>Q(t.buttonSize)),H=()=>{const e=c(a.value);P(e,a.value)||(a.value=e)},C=e=>{t.beforeChange?ne(t.beforeChange,{args:[e],done(){a.value=e}}):a.value=e},V=()=>{if(u==="plus"&&m.value||u==="minus"&&r.value){i("overlimit",u);return}const e=u==="minus"?-t.step:+t.step,n=c(Y(+a.value,e));C(n),i(u)},O=e=>{const n=e.target,{value:s}=n,{decimalLength:b}=t;let l=F(String(s),!t.integer);if(z(b)&&l.includes(".")){const M=l.split(".");l=`${M[0]}.${M[1].slice(0,+b)}`}t.beforeChange?n.value=String(a.value):P(s,l)||(n.value=l);const U=l===String(+l);C(U?+l:l)},W=e=>{var n;t.disableInput?(n=N.value)==null||n.blur():i("focus",e)},$=e=>{const n=e.target,s=c(n.value);n.value=String(s),a.value=s,te(()=>{i("blur",e),Z()})};let _,f;const E=()=>{f=setTimeout(()=>{V(),E()},le)},j=()=>{t.longPress&&(_=!1,clearTimeout(f),f=setTimeout(()=>{_=!0,V(),E()},se))},B=e=>{t.longPress&&(clearTimeout(f),_&&w(e))},K=e=>{t.disableInput&&w(e)},L=e=>({onClick:n=>{w(n),u=e,V()},onTouchstartPassive:()=>{u=e,j()},onTouchend:B,onTouchcancel:B});return T(()=>[t.max,t.min,t.integer,t.decimalLength],H),T(()=>t.modelValue,e=>{P(e,a.value)||(a.value=c(e))}),T(a,e=>{i("update:modelValue",e),i("change",e,{name:t.name})}),X(()=>t.modelValue),()=>o("div",{role:"group",class:S([t.theme])},[I(o("button",R({type:"button",style:x.value,class:[S("minus",{disabled:r.value}),{[k]:!r.value}],"aria-disabled":r.value||void 0},L("minus")),[o("span",{class:"van-stepper__minus__before"},null)]),[[y,t.showMinus]]),I(o("input",{ref:N,type:t.integer?"tel":"text",role:"spinbutton",class:S("input"),value:a.value,style:G.value,disabled:t.disabled,readonly:t.disableInput,inputmode:t.integer?"numeric":"decimal",placeholder:t.placeholder,"aria-valuemax":t.max,"aria-valuemin":t.min,"aria-valuenow":a.value,onBlur:$,onInput:O,onFocus:W,onMousedown:K},null),[[y,t.showInput]]),I(o("button",R({type:"button",style:x.value,class:[S("plus",{disabled:m.value}),{[k]:!m.value}],"aria-disabled":m.value||void 0},L("plus")),[o("span",{class:"van-stepper__plus__before"},null),o("span",{class:"van-stepper__plus__after"},null)]),[[y,t.showPlus]])])}}),oe=p(ue),be=oe;export{be as V};
